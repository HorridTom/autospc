% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/algorithm.R
\name{create_SPC_auto_limits_table}
\alias{create_SPC_auto_limits_table}
\title{Automatically recalculate SPC control limits}
\usage{
create_SPC_auto_limits_table(
  data,
  chartType,
  periodMin,
  baseline,
  runRuleLength,
  maxNoOfExclusions,
  noRegrets,
  verbosity,
  noRecals,
  recalEveryShift,
  rule2Tolerance,
  showLimits,
  overhangingReversions,
  mr_screen_max_loops
)
}
\arguments{
\item{data}{A data frame. For an XMR, C or C' chart, must have columns:
\itemize{
\item x, the subgrouping variable, to be plotted on the horizontal axis;
\item y, the variable of interest to be plotted on the vertical axis;
} \cr
For a P or P' chart, must have columns:
\itemize{
\item x, the subgrouping variable, to be plotted on the horizontal axis;
\item n, the total count or denominator;
\item y, the count meeting criteria, or numerator;
}}

\item{chartType}{The type of chart you wish to plot. Available options are:
"XMR", "MR", "C", "C'", "P", "P'".
\subsection{Algorithm Parameters}{

Parameters that control behaviour of the algorithm used to re-establish
control limits.
}}

\item{periodMin}{The minimum number of points (subgroups) per period,
i.e. the minimum number of points required to form control limits.}

\item{baseline}{Integer, overrides periodMin for the first calculation period
only, if specified}

\item{runRuleLength}{The minimum number of consecutive points above or below
the centre line constituting a shift (or "rule 2") break.}

\item{maxNoOfExclusions}{The maximum number of extreme points to exclude from
limit calculations.}

\item{noRegrets}{Boolean signifying which version of the algorithm should be
used. Defines whether limits can change as more data is added or not.}

\item{verbosity}{Integer 0-2 specifying how talkative the algorithm is in the
standard output log; the higher the number the more information is provided,
none if 0.}

\item{noRecals}{Boolean - if TRUE, do not recalculate control limits, instead
extend limits calculated from the first periodMin points.}

\item{recalEveryShift}{Boolean - whether to bypass the Stable Shift Algorithm
and simply re-establish limits at every shift rule break (respecting
periodMin)}

\item{rule2Tolerance}{Minimum difference between a point's vertical position
and the centre line to count as "on the centre line" for the purposes of
shift rule breaks}

\item{showLimits}{Boolean controlling whether or not to display centre line
and control limits}

\item{overhangingReversions}{Boolean determining whether rule breaks in the
opposite direction to a rule break triggering a candidate recalculation
prevent recalculation even if they overhang the end of the candidate
calculation period. Set to FALSE only with noRegrets = FALSE.
\subsection{SPC Parameters}{

Parameters that control how cetnre line and control limits are established
for each period, and details of how SPC rules are applied
}}

\item{mr_screen_max_loops}{Integer or Inf specifying maximum number of times
to recursively ignore mr values above the upper range limit when calculating
xmr limits. Note this does not affect the calculation of the upper range
limit on the mr chart.}
}
\value{
data frame with limits, rule breaks and additional info needed for
plotting
}
\description{
\code{create_SPC_auto_limits_table} applies the Stable Shift Algorithm to automate
recalculation of control limits.
}
\examples{
# Calculate limts for a C' chart for count of monthly attendances

df <- ed_attendances_monthly \%>\%
        dplyr::rename(x = Month_Start,
                      y = Att_All)

limits_table <- create_SPC_auto_limits_table(
  df,
  chartType = "C'",
  periodMin = 21,
  baseline = NULL,
  runRuleLength = 8,
  maxNoOfExclusions = 3,
  noRegrets = TRUE,
  verbosity = 1L,
  noRecals = FALSE,
  recalEveryShift = FALSE,
  rule2Tolerance = 0,
  showLimits = TRUE,
  overhangingReversions = TRUE,
  mr_screen_max_loops = 1L
)

head(limits_table)

}
